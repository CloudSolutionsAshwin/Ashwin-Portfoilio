<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta http-equiv="X-UA-Compatible" content="ie=edge">


    <title>Ashwin Sharma Portfolio Website</title>

    <link rel="shortcut icon" href="../assets/img/61u3uz.png" type="image/x-icon">

    <link rel="stylesheet" type="text/css" href="../assets/css/themify-icons.css">

    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css">

    <link rel="stylesheet" type="text/css" href="../assets/vendor/animate/animate.css">

    <link rel="stylesheet" type="text/css" href="../assets/vendor/owl-carousel/owl.carousel.css">

    <link rel="stylesheet" type="text/css" href="../assets/vendor/perfect-scrollbar/css/perfect-scrollbar.css">

    <link rel="stylesheet" type="text/css" href="../assets/vendor/nice-select/css/nice-select.css">

    <link rel="stylesheet" type="text/css" href="../assets/vendor/fancybox/css/jquery.fancybox.min.css">

    <link rel="stylesheet" type="text/css" href="../assets/css/virtual.css">

    <link rel="stylesheet" type="text/css" href="../assets/css/topbar.virtual.css">
</head>

<body class="theme-red">

    <!-- Back to top button -->
    <div class="btn-back_to_top">
        <span class="ti-arrow-up"></span>
    </div>


        <div class="vg-page page-home" id="home" style="background-image: url(../assets/img/new2.jpg);background-size: cover;">
        <!-- Navbar -->
        <div class="navbar navbar-expand-lg navbar-dark sticky" data-offset="500">
            <div class="container">
                <a href="index.html" class="navbar-brand">Ashwin Sharma</a>
                <button class="navbar-toggler" data-toggle="collapse" data-target="#main-navbar" aria-expanded="true">
                    <span class="ti-menu"></span>
                </button>
                <div class="collapse navbar-collapse" id="main-navbar">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item active">
                            <a href="#home" class="nav-link" data-animate="scrolling">Home</a>
                        </li>
                        <li class="nav-item">
                            <a href="#about" class="nav-link" data-animate="scrolling">About</a>
                        </li>
                        <li class="nav-item">
                            <a href="#portfolio" class="nav-link" data-animate="scrolling">Portfolio</a>
                        </li>
                        <li class="nav-item">
                            <a href="#blog" class="nav-link" data-animate="scrolling">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a href="#contact" class="nav-link" data-animate="scrolling">Contact</a>
                        </li>
                    </ul>
                    <!-- <ul class="nav ml-auto">
            <li class="nav-item">
              <button class="btn btn-fab btn-theme no-shadow">En</button>
            </li>
          </ul> -->
                </div>
            </div>
        </div> <!-- End Navbar -->
        <!-- Caption header -->
        <div class="caption-header text-center wow zoomInDown">
            <h5 class="fg-theme">Welcome to my blog</h5>
            <h3 class="fw-light mb-4">Set It and Forget It: Automating RDS Start/Stop for Off-Peak Hours</h3>
            <div class="badge">By Ashwin Sharma</div>
        </div> <!-- End Caption header -->

    </div>

    <div class="vg-page page-about" id="about">
        <div class="container py-5">
            <div>
                <div style="margin-right: 10px; margin-left: 11px">
                    <h1 class="fw-light">Set It and Forget It: Automating RDS Start/Stop for Off-Peak Hours</h1>
                    <h5 class="fg-theme mb-3">By Ashwin Sharma</h5>

                    <div class="testi-content">
                        <br>
                        <strong>Efficient Cloud Resource Management: How Automating RDS Start/Stop Can Save You Money</strong>
                        <br>
                        <p>Managing cloud resources efficiently is key to keeping costs under control while maximizing performance. One effective way to achieve this is by automating the start and stop schedules of your Amazon RDS instances using AWS Lambda. Here’s why this strategy is so valuable and how it can benefit your organization in straightforward terms.</p>
                        <br>
                        <strong>Cost Optimization and Resource Efficiency: Saving Money by Turning Things Off</strong>
                        <br>
                        <p>Think of it like leaving the lights on in your home when you're not there — it wastes energy and increases your bills. Similarly, running your Amazon RDS instances 24/7, even when they’re not in use, can significantly drive up costs. By automating the process of shutting down these instances during off-hours or periods of inactivity, you can make a substantial dent in your cloud spending.</p>
                        <br>
                        <strong>Automation and Flexibility: Letting AWS Lambda Handle the Repetitive Tasks</strong>
                        <br>
                        <p>Manual tasks are often tedious and prone to human error. AWS Lambda helps solve this by automating the start/stop process for your RDS instances. Instead of remembering to turn them off at night or over weekends, Lambda takes care of it automatically, ensuring that your instances are only running when needed — all without requiring any intervention from you.</p>
                        <br>
                        <strong>Scalability: Adjusting Automatically to Your Needs</strong>
                        <br>
                        <p>AWS Lambda’s ability to scale automatically is another major advantage. Whether you have a handful of RDS instances or a more complex, larger setup, Lambda adjusts to meet your needs. This flexibility ensures that your automation workflows continue to work seamlessly, no matter the size or complexity of your infrastructure.</p>
                        <br>
                        <strong>Security and Compliance: Being Smart About When Resources Are Active</strong>
                        <br>
                        <p>Turning off RDS instances when they’re not in use also adds a layer of security to your cloud environment. With fewer instances running, there’s less surface area for potential cyber-attacks or vulnerabilities. Moreover, automating the start/stop schedule helps you stay compliant with internal policies and external regulations, ensuring that your resources are only accessible during the hours they should be..</p>
                        <br>
                        <strong>Architecture diagram:-</strong>
                        <br>
                        <img src="../assets/img/work/Blank diagram.png" style="max-width: 100%; height: auto; display: block; margin: 20px auto;"/>     
                        
                        <strong>What You Need Before You Start:-</strong>
                        <p>Make sure you have the following:</p>
                        <br>
                        <b>1. An AWS account</b> with admin access to Amazon RDS.<br>
                        <b>2. An RDS database instance</b> like “example-1”, which I already have set up.<br>

                        <img src="../assets/img/work/1_djxT-vDi0P94kEkk84XAOA.webp" style="max-width: 100%; height: auto; display: block; margin: 20px auto;"/>
                        <br>
                        <strong>Step 1 — Assign Tags to the RDS Database Instance</strong>
                        

                        <img src="../assets/img/work/image1.webp" style="max-width: 100%; height: auto; display: block; margin: 20px auto;"/>
                        <br>
                        <p>- Go to the <strong>Amazon RDS Console</strong> and select the database. Then, choose the DB instance that you want to add tags to.</p>
                        <p>- In the <strong>Tags</strong> section, click on <strong>Add tags.</strong></p>
                        <br>- For the <strong>Tag Key</strong>, type AutoStart and AutoStop. For the <strong>Value</strong>, type True, then click on <strong>Add.</strong>
                        <br>
                        <img src="../assets/img/work/image2.webp" style="max-width: 100%; height: auto; display: block; margin: 20px auto;"/>
                    </div>
                        <br>
                        <strong>Step 2 — Create an IAM Policy and Role for Lambda</strong>
                    
                        <p>Now, we’ll create an IAM policy and a role that allows AWS Lambda to start and stop your RDS instances.
                        <br>1. Open the IAM console. In the left-hand menu under Access Management, click on Policies and then select Create Policy.</p>                    
                    
                        <img src="../assets/img/work/image3.webp" style="max-width: 100%; height: auto; display: block; margin: 20px auto;"/>
                        <br>
                        <strong>Step 2 — Create an IAM Policy and Role for Lambda</strong>
                        <p>Next, we will create an IAM policy and role that allows AWS Lambda to start and stop the RDS instances</p>
                
                        <p>1. Open the IAM console and, from the left-hand navigation, click on Policies under Access Management. Then click on Create Policy.</p>
                        <p>2. In the Create Policy screen, choose the JSON tab to define a custom policy.</p>
                        <p>3. Copy and paste the following JSON policy into the editor:</p>
                        <br>
                        <pre>
                            {
                            “Version”: “2012–10–17”,
                            “Statement”: [
                            {
                            “Sid”: “Statement1”,
                            “Effect”: “Allow”,
                            “Action”: [
                            “rds:DescribeDBClusterParameters”,
                            “rds:StartDBCluster”,
                            “rds:StopDBCluster”,
                            “rds:StopDBInstance”,
                            “rds:StartDBInstance”,
                            “rds:ListTagsForResource”,
                            “rds:DescribeDBInstances”,
                            “rds:DescribeSourceRegions”,
                            “rds:DescribeDBClusterEndpoints”,
                            “rds:DescribeDBClusters”
                            ],
                            “Resource”: “*”
                            }
                            ]
                            }
                        </pre>
                            <br>
                            <p>After pasting the policy, click on Review Policy and give the policy a name (e.g., LambdaRDSStartStopPolicy), then click Create Policy.</p>
                            <br>
                            <strong>Step 3 — Create an IAM Role and Attach the Policy</strong>
                            <p>Next, we will create an IAM role that Lambda can assume, and we will attach the policy you just created to this role.</p>
                            
                            <p>1. Go to the <strong>IAM console.</strong></p>
                            
                            <p>2. In the left-hand menu, click on Roles.</p>
                            
                            <p>3. Click on <strong>Create role.</strong></p>
                            
                            <p>4. Choose <strong>Lambda</strong> as the trusted service that will use this role.</p>
                            
                            <p>5. Click on <strong>Next: Permissions</strong> to move to the next step.</p>
                            
                            <p>6. Now, you have created an IAM role with the required permissions for your Lambda function to start and stop Amazon RDS instances.</p>
                            
                            <p>7. When you create or update your Lambda function in the AWS Lambda console, make sure to assign this IAM role to the function.</p>
                            
                            <br>
                            <strong>Create a Lambda Function to Stop the Database</strong>
                            <p>We will create two Lambda functions: one for stopping the database and another for starting it. First, let’s focus on creating the function to stop the database.</p>
                            <p>1. Open the <strong>Lambda console.</strong> In the left-hand menu, click on Functions, then click on <strong>Create function.</strong></p>
                            <br>
                            <img src="../assets/img/work/image4.webp" style="max-width: 100%; height: auto; display: block; margin: 20px auto;"/>
                            <br>
                            <p>2. Select <strong>Author from scratch.</strong></p>
                            <p>3. Give your function a name (e.g., StopRDSInstanceFunction), choose <strong>Python</strong> as the runtime, and under <strong>Existing role,</strong> select the IAM role you created earlier (e.g., LambdaRDSStartStopRole).</p>
                            
                            <p>4. On the <strong>Function details</strong> page, go to the <strong>Function code</strong> section.</p>
                            
                            <p>5. Delete the default sample code.</p>
                            
                            <p>6.Copy and paste the following code to stop the RDS instance into the code editor:</p>
                            <br>
                            <pre>
                                import boto3
                                rds = boto3.client(‘rds’)
                                
                                def lambda_handler(event, context):
                                
                                # Stop DB instances
                                dbs = rds.describe_db_instances()
                                for db in dbs[‘DBInstances’]:
                                # Check if the DB instance is not already stopped
                                if (db[‘DBInstanceStatus’] == ‘available’):
                                try:
                                GetTags = rds.list_tags_for_resource(ResourceName=db[‘DBInstanceArn’])[‘TagList’]
                                for tags in GetTags:
                                # If the tag “AutoStop=True” is set for the instance, stop it
                                if(tags[‘Key’] == ‘AutoStop’ and tags[‘Value’] == ‘True’):
                                result = rds.stop_db_instance(DBInstanceIdentifier=db[‘DBInstanceIdentifier’])
                                print (“Stopping instance: {0}.”.format(db[‘DBInstanceIdentifier’]))
                                except Exception as e:
                                print (“Cannot stop instance {0}.”.format(db[‘DBInstanceIdentifier’]))
                                print(e)
                                
                                if __name__ == “__main__”:
                                lambda_handler(None, None)
                            </pre>
                            <br>
                            <img src="../assets/img/work/image5.webp" style="max-width: 100%; height: auto; display: block; margin: 20px auto;"/>
                            <br>
                            <p>- Click on <strong>Deploy</strong> to create and save your Lambda function.</p>
                            
                            <p>- Go to the <strong>Configuration</strong> tab, then select <strong>Environment Variables.</strong> Click on Edit and add the environment variables as shown below.</p>
                            <br>
                            <img src="../assets/img/work/image6.webp" style="max-width: 100%; height: auto; display: block; margin: 20px auto;"/>
                            <br>
                            <p>- You can test your Lambda functions directly in the Lambda console by clicking on <strong>Test.</strong></p>
                            
                            <strong>Create a Lambda Function to Start the RDS Database</strong>
                            
                            <p>1. Follow the same steps as before, but this time, create a new Lambda function that will start the RDS instances.</p>
                            
                            <p>2. Copy and paste the code to start RDS instances into the code editor.</p>
                            
                            <pre>
                                import boto3
                                rds = boto3.client(‘rds’)
                                
                                def lambda_handler(event, context):
                                
                                # Start DB Instances
                                dbs = rds.describe_db_instances()
                                for db in dbs[‘DBInstances’]:
                                # Check if the DB instance is stopped. If so, start it.
                                if (db[‘DBInstanceStatus’] == ‘stopped’):
                                try:
                                GetTags = rds.list_tags_for_resource(ResourceName=db[‘DBInstanceArn’])[‘TagList’]
                                for tags in GetTags:
                                # If the tag “AutoStart=True” is set for the instance, start it
                                if(tags[‘Key’] == ‘AutoStart’ and tags[‘Value’] == ‘True’):
                                result = rds.start_db_instance(DBInstanceIdentifier=db[‘DBInstanceIdentifier’])
                                print (“Starting instance: {0}.”.format(db[‘DBInstanceIdentifier’]))
                                except Exception as e:
                                print (“Cannot start instance {0}.”.format(db[‘DBInstanceIdentifier’]))
                                print(e)
                                
                                if __name__ == “__main__”:
                                lambda_handler(None, None)
                                
                                This code checks all RDS instances and starts those with the tag AutoStart=True.
                            </pre>
                                <br>
                            <p>3. Click on <strong>Deploy</strong> to create and save your Lambda function.</p>
                            
                            <p>4. Go to the <strong>Configuration</strong> tab, then click on <strong>Environment Variables.</strong> Select <strong>Edit</strong> and add the environment variables as shown below.</p>
                            
                            <p>5. You can test your Lambda functions directly in the Lambda console by clicking on <strong>Test.</strong></p>
                            
                            <strong>Step 4.1 — Create an Amazon EventBridge Rule to Stop RDS Database.</strong>
                            
                            <p>1. Amazon EventBridge rules will trigger the Lambda functions we created to stop or start the tagged database on a scheduled basis.</p>
                            
                            <p>2. Enter the rule details, such as the name and description. Choose <strong>Rule type</strong> as <strong>Schedule</strong>, then click on <strong>Continue.</strong></p>
                            
                            <p>3. In the <strong>Schedule pattern</strong> section, select <strong>Recurring schedule</strong> and choose <strong>Cron-based schedule</strong> for the schedule type.</p>
                            
                            <p>4. Enter the following <strong>Cron expression:</strong> (0 20 * * ? *). This schedule will trigger every day at 8:00 PM. Afterward, click on <strong>Next.</strong></p>
                            
                            <p>5. In the <strong>Select Targets</strong> section, choose <strong>AWS Lambda</strong> and select <strong>Invoke.</strong></p>
                            
                            <p>6. For <strong>Function,</strong> choose the <strong>stop function</strong> you created (e.g., rdsstop).</p>
                            
                            <p>7. Click on <strong>Next,</strong> then review your settings and click <strong>Create</strong> to create the schedule.</p>
                            
                            <strong>Step 4.2 — Create an Amazon EventBridge Rule to Start RDS</strong>
                            
                            <p>1. Follow the same steps as before to create a rule that triggers the <strong>rdsstart</strong> Lambda function at your preferred scheduled time, such as <strong>8:00 AM.</strong></p>
                            
                            <p>Happy learning!</p>
                </div>
                

            </div>
        </div>

    </div>
    <!-- Footer -->
    <div class="vg-footer">
        <h1 class="text-center">Ashwin Sharma</h1>
        <div class="container">
            <div class="row">
                <div class="col-lg-4 py-3">
                    <div class="footer-info">
                        <p>Where to find me</p>
                        <hr class="divider">
                        <p class="fs-large fg-white">Ahmedabad, Gujarat</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3 py-3">
                    <div class="float-lg-right">
                        <p>Follow me</p>
                        <hr class="divider">
                        <ul class="list-unstyled">
                            <li><a href="http://www.linkedin.com/in/iamashwins">Linkedin</a></li>
                            <li><a href="#">Instagram</a></li>
                            <li><a href="#">Facebook</a></li>
                            <li><a href="#">Twitter</a></li>

                        </ul>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3 py-3">
                    <div class="float-lg-right">
                        <p>Contact me</p>
                        <hr class="divider">
                        <ul class="list-unstyled">
                            <li>iamashwin073@gmail.com</li>
                            <li>722-604-6826</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="row justify-content-center mt-3">
                <!-- <div class="col-12 mb-3">
          <h3 class="fw-normal text-center">Subscribe</h3>
        </div>
        <div class="col-lg-6">
          <form class="mb-3">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Email address">
              <input type="submit" class="btn btn-theme no-shadow" value="Subscribe">
            </div>
          </form>
        </div> -->
                <div class="col-12">
                    <p class="text-center mb-0 mt-4">Copyright &copy;2023. All right reserved | This Website is made
                        with <span class="ti-heart fg-theme-red"></span> by Ashwin Sharma</p>
                </div>
            </div>
        </div>
    </div> <!-- End footer -->



    <script src="../assets/js/jquery-3.5.1.min.js"></script>

    <script src="../assets/js/bootstrap.bundle.min.js"></script>

    <script src="../assets/vendor/owl-carousel/owl.carousel.min.js"></script>

    <script src="../assets/vendor/perfect-scrollbar/js/perfect-scrollbar.js"></script>

    <script src="../assets/vendor/isotope/isotope.pkgd.min.js"></script>

    <script src="../assets/vendor/nice-select/js/jquery.nice-select.min.js"></script>

    <script src="../assets/vendor/fancybox/js/jquery.fancybox.min.js"></script>

    <script src="../assets/vendor/wow/wow.min.js"></script>

    <script src="../assets/vendor/animateNumber/jquery.animateNumber.min.js"></script>

    <script src="../assets/vendor/waypoints/jquery.waypoints.min.js"></script>

    <script src="../assets/js/google-maps.js"></script>

    <script src="../assets/js/topbar-virtual.js"></script>

    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAIA_zqjFMsJM_sxP9-6Pde5vVCTyJmUHM&callback=initMap"></script>

</body>

</html>
